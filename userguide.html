<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 26 April 2016
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="iso-8859-1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Commons Documentation Team" />
    <meta name="Date-Revision-yyyymmdd" content="20160426" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Apache Commons Crypto &#x2013; Commons Crypto - User guide</title>

	<link rel="stylesheet" href="./css/bootstrap.min.css" type="text/css" />
	<link rel="stylesheet" href="./css/site.css" type="text/css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

	<script type="text/javascript" src="./js/jquery.min.js"></script>
	<script type="text/javascript" src="./js/bootstrap.min.js"></script>
	<script type="text/javascript" src="./js/prettify.min.js"></script>
	<script type="text/javascript" src="./js/site.js"></script>

                            
<link rel="stylesheet" type="text/css" media="all" href="./css/prettify.css"/>                                
<script src="./js/prettify.js" type="text/javascript"></script>                                
<script type="text/javascript">window.onload=function() {
              prettyPrint();
          }</script>                  
      </head>

	<body class="composite">
                          <a href="http://commons.apache.org/" id="bannerLeft" title="Apache Commons logo">
                                                                                        <img class="logo-left" src="./images/commons-logo.png"  alt="Apache Commons logo"/>
                </a>
                                              <a href="index.html" id="bannerRight" title="Commons Crypto? logo">
                                                                                                <img class="logo-right" src="images/logo.png"  alt="Commons Crypto? logo"/>
                </a>
      		<div class="clear"></div>

		<div class="navbar">
			<div class="navbar-inner">
				<div class="container-fluid">
					<a class="brand" href="http://commons.apache.org/proper/commons-crypto">Apache Commons Crypto &trade;</a>
					<ul class="nav">      
                    
            <li id="publishDate">Last Published: 26 April 2016</li>
      <li class="divider">|</li> <li id="projectVersion">Version: 1.0.0-SNAPSHOT</li>
  </ul>
                    <div class="pull-right">	<ul class="nav">
						<li>
		              <a href="http://www.apachecon.com/" class="externalLink" title="ApacheCon">
    ApacheCon</a>
  		</li>
					<li>
		              <a href="http://www.apache.org" class="externalLink" title="Apache">
    Apache</a>
  		</li>
					<li>
		              <a href="../../" title="Commons">
    Commons</a>
  		</li>
		</ul>
</div>
				</div>
			</div>
		</div>

		<div class="container-fluid">
			<table class="layout-table">
				<tr>
					<td class="sidebar">
						<div class="well sidebar-nav">
										<ul class="nav nav-list">
		 		            						 <li class="nav-header">Documentation</li>
																				<li class="none">
		              <a href="../../crypto/download_crypto.cgi" title="Download">
    Download</a>
  				</li>
 														<li class="none">
		              <a href="download_crypto.html" title="Download">
    Download</a>
  				</li>
 															<li class="none active">
		              <a href="userguide.html" title="Users guide">
    Users guide</a>
  				</li>
 														<li class="none">
		              <a href="apidocs/index.html" title="Javadoc trunk">
    Javadoc trunk</a>
  				</li>
 								</ul>
			<ul class="nav nav-list">
		 		            									 <li class="nav-header"><i class="icon-cog"></i>Development</li>
																				<li class="none">
		              <a href="mail-lists.html" title="Mailing Lists">
    Mailing Lists</a>
  				</li>
 														<li class="none">
		              <a href="issue-tracking.html" title="Issue Tracking">
    Issue Tracking</a>
  				</li>
 														<li class="none">
		              <a href="source-repository.html" title="Source Repository">
    Source Repository</a>
  				</li>
 								</ul>
			<ul class="nav nav-list">
		 		            									 <li class="nav-header"><i class="icon-info-sign"></i>Project Documentation</li>
																								                                                                                                                                                                                                              								<li class="collapsed">
		              <a href="project-info.html" title="Project Information">
    Project Information</a>
  									</li>
 																		                                                                                                                                                        								<li class="collapsed">
		              <a href="project-reports.html" title="Project Reports">
    Project Reports</a>
  									</li>
 								</ul>
			<ul class="nav nav-list">
		 		            						 <li class="nav-header">Commons</li>
																				<li class="none">
		              <a href="../../" title="Home">
    Home</a>
  				</li>
 														<li class="none">
		              <a href="http://www.apache.org/licenses/" class="externalLink" title="License">
    License</a>
  				</li>
 																		                          								<li class="collapsed">
		              <a href="../../components.html" title="Components">
    Components</a>
  									</li>
 																		                          								<li class="collapsed">
		              <a href="../../sandbox/index.html" title="Sandbox">
    Sandbox</a>
  									</li>
 																		                          								<li class="collapsed">
		              <a href="../../dormant/index.html" title="Dormant">
    Dormant</a>
  									</li>
 								</ul>
			<ul class="nav nav-list">
		 		            						 <li class="nav-header">General Information</li>
																				<li class="none">
		              <a href="../../security.html" title="Security">
    Security</a>
  				</li>
 														<li class="none">
		              <a href="../../volunteering.html" title="Volunteering">
    Volunteering</a>
  				</li>
 														<li class="none">
		              <a href="../../patches.html" title="Contributing Patches">
    Contributing Patches</a>
  				</li>
 														<li class="none">
		              <a href="../../building.html" title="Building Components">
    Building Components</a>
  				</li>
 														<li class="none">
		              <a href="../../commons-parent-pom.html" title="Commons Parent Pom">
    Commons Parent Pom</a>
  				</li>
 														<li class="none">
		              <a href="../../build-plugin/index.html" title="Commons Build Plugin">
    Commons Build Plugin</a>
  				</li>
 														<li class="none">
		              <a href="../../releases/index.html" title="Releasing Components">
    Releasing Components</a>
  				</li>
 														<li class="none">
		              <a href="http://wiki.apache.org/commons/FrontPage" class="externalLink" title="Wiki">
    Wiki</a>
  				</li>
 								</ul>
			<ul class="nav nav-list">
		 		            						 <li class="nav-header">ASF</li>
																				<li class="none">
		              <a href="http://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How the ASF works">
    How the ASF works</a>
  				</li>
 														<li class="none">
		              <a href="http://www.apache.org/foundation/getinvolved.html" class="externalLink" title="Get Involved">
    Get Involved</a>
  				</li>
 														<li class="none">
		              <a href="http://www.apache.org/dev/" class="externalLink" title="Developer Resources">
    Developer Resources</a>
  				</li>
 														<li class="none">
		              <a href="http://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsorship">
    Sponsorship</a>
  				</li>
 														<li class="none">
		              <a href="http://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks">
    Thanks</a>
  				</li>
 								</ul>
							</div>
						<div id="poweredBy">
							                                                                                                      <a href="http://www.apache.org/events/current-event.html" title="ApacheCon" class="builtBy">
        <img class="builtBy"  alt="ApacheCon" src="http://www.apache.org/events/current-event-125x125.png"    />
      </a>
                                                                                                    <a href="http://maven.apache.org/" title="Maven" class="builtBy">
        <img class="builtBy"  alt="Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
          						</div>
					</td>
					<td class="content">
						<!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor 
  license agreements. See the NOTICE file distributed with this work for additional 
  information regarding copyright ownership. The ASF licenses this file to 
  You under the Apache License, Version 2.0 (the "License"); you may not use 
  this file except in compliance with the License. You may obtain a copy of 
  the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required 
  by applicable law or agreed to in writing, software distributed under the 
  License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS 
  OF ANY KIND, either express or implied. See the License for the specific 
  language governing permissions and limitations under the License. -->
  
    <!-- ================================================== -->
    <div class="section">
<h2><a name="User_guide"></a>User guide</h2>
      
<p>Apache Commons Crypto is a cryptographic library optimized with AES-NI
        (Advanced Encryption
        Standard New Instructions). It provides Java API for both cipher level and Java stream
        level. Developers can use it to implement high performance AES encryption/decryption with
        the minimum code and effort. Please note that Apache Commons Crypto doesn't implement the cryptographic
        algorithm such as AES directly. It wraps to Openssl or JCE which implement the algorithms.
      </p>
      
<div class="section">
<h3><a name="Interfaces_Overview"></a>Interfaces Overview</h3>
        
<p>Interfaces and classes used by the various implementation in the sub-packages.</p>
        
<table border="0" class="bodyTable">
          
<tr class="a">
            
<td width="150">
              <a href="apidocs/index.html">cipher
              </a>
            </td>
            
<td>
              The interface of cryptographic cipher for encryption and decryption.
            </td>
          </tr>

          
<tr class="b">
            
<td width="150">
              <a href="apidocs/index.html">random
              </a>
            </td>
            
<td>
              The interface for SecureRandom.
            </td>
          </tr>

          
<tr class="a">
            
<td width="150">
              <a href="apidocs/index.html">stream
              </a>
            </td>
            
<td>
              The interface wraps the underlying stream and it automatically encrypts the stream when data is written and decrypts the stream when data is read.
            </td>
          </tr>

        </table>
      </div>
      
<div class="section">
<h3><a name="Usage"></a>Usage</h3>
        
<ol style="list-style-type: decimal">
        
<div class="section">
<h4><a name="Usage_of_Random_API"></a>Usage of Random API</h4>
        
<table border="0" class="bodyTable">
        
<tr class="a">
        
<td>
        //Constructs a byte array to store random data.<br />
        byte[] data = new byte[16];<br />
        Properties properties = new Properties();<br />
        // Default value is com.intel.chimera.random.JavaSecureRandom.<br />
        properties.setProperty(&quot;chimera.crypto.secure.random.classes&quot;, &quot;com.intel.chimera.random.OpensslSecureRandom,com.intel.chimera.random.OsSecureRandom&quot;);<br />
        //Gets the 'SecureRandom' instance.<br />
        SecureRandom secureRandom = SecureRandomFactory.getSecureRandom(properties);<br />
        //Generates random bytes and places them into the byte array.<br />
        secureRandom.nextBytes(data);<br />
        //Closes the SecureRandom.<br />
        secureRandom.close();<br />
        </td>
        </tr>
        </table>


        </div>
<div class="section">
<h4><a name="Usage_of_Cipher_API"></a>Usage of Cipher API</h4>
        
<table border="0" class="bodyTable">
        
<tr class="a">
        
<td>
        Properties properties = new Properties();<br />
        // Default value is com.intel.chimera.crypto.JceCipher.<br />
        properties.setProperty(&quot;chimera.crypto.cipher.classes&quot;, &quot;com.intel.chimera.crypto.OpensslCipher,com.intel.chimera.crypto.JceCipher&quot;);<br />
        Cipher cipher = Utils.getCipherInstance(CipherTransformation.AES_CTR_NOPADDING, properties);<br /><br />
        properties = new Properties();<br />
        // Default value is com.intel.chimera.random.JavaSecureRandom.<br />
        properties.setProperty(&quot;chimera.crypto.secure.random.classes&quot;, &quot;com.intel.chimera.random.OpensslSecureRandom,com.intel.chimera.random.OsSecureRandom&quot;);<br />
        //Gets the 'SecureRandom' instance.<br />
        SecureRandom secureRandom = SecureRandomFactory.getSecureRandom(properties);<br />
        // Available key length is: 16, 24, 32 bytes.<br />
        //Constructs the crypto key for cipher.<br />
        byte[] key = new byte[16];<br />
        //Generates random bytes and places them into the byte array.<br />
        secureRandom.nextBytes(key);<br />
        // IV length is always 16 bytes.<br />
        //Constructs the crypto iv for cipher.<br />
        byte[] iv = new byte[16];<br />
        //Generates random bytes and places them into the byte array.<br />
        secureRandom.nextBytes(iv);<br />
        //Closes the SecureRandom.<br />
        secureRandom.close();<br />
        </td>
        </tr>
        </table>


        
<div class="section">
<h5><a name="Usage_of_Byte_Array_EncryptionDecryption"></a>Usage of Byte Array Encryption/Decryption</h5>
        
<table border="0" class="bodyTable">
        
<tr class="a">
        
<td>
        String input = &quot;hello world!&quot;;<br />
        int inputOffset = 0;<br />
        int inputLen = input.length();<br />
        byte[] output = new byte[1024];<br />
        int outputOffset = 0;<br />
        //Initializes the cipher with ENCRYPT_MODE,key and iv.<br />
        cipher.init(Cipher.ENCRYPT_MODE, key, iv);<br />
        //Continues a multiple-part encryption/decryption operation for byte array.<br />
        cipher.update(input.getBytes(&quot;UTF-8&quot;), inputOffset, inputLen, output, outputOffset);<br />
        //We should call do final at the end of encryption/decryption.<br />
        cipher.doFinal(inBuffer, outBuffer);<br />
        //Closes the cipher.<br />
        cipher.close();
        </td>
        </tr>
        </table>


        </div>
<div class="section">
<h5><a name="Usage_of_ByteBuffer_EncryptionDecryption"></a>Usage of ByteBuffer Encryption/Decryption</h5>
        
<table border="0" class="bodyTable">
        
<tr class="a">
        
<td>
        int bufferSize = 4096;<br />
        ByteBuffer inBuffer = ByteBuffer.allocateDirect(bufferSize);<br />
        ByteBuffer outBuffer = ByteBuffer.allocateDirect(bufferSize);<br />
        inBuffer.put(&quot;The data you want to encrypt or decrypt&quot;.getBytes(&quot;UTF-8&quot;));<br />
        //Initializes the cipher with ENCRYPT_MODE,key and iv.<br />
        cipher..init(Cipher.ENCRYPT_MODE, key, iv);<br />
        //Continues a multiple-part encryption/decryption operation for byte array.<br />
        cipher.update(inBuffer, outBuffer);<br />
        //We should call do final at the end of encryption/decryption.<br />
        cipher.doFinal(inBuffer, outBuffer);<br />
        //Closes the cipher.<br />
        cipher.close();
        </td>
        </tr>
        </table>


        </div></div>
<div class="section">
<h4><a name="Usage_of_Stream_API"></a>Usage of Stream API</h4>
        
<table border="0" class="bodyTable">
        
<tr class="a">
        
<td>
        Properties properties = new Properties();<br />
        // Default value is com.intel.chimera.random.JavaSecureRandom.<br />
        properties.setProperty(&quot;chimera.crypto.secure.random.classes&quot;, &quot;com.intel.chimera.random.OpensslSecureRandom,com.intel.chimera.random.OsSecureRandom&quot;);<br />
        //Gets the 'SecureRandom' instance.<br />
        SecureRandom secureRandom = SecureRandomFactory.getSecureRandom(properties);<br />
        // Available key length is: 16, 24, 32 bytes.<br />
        //Constructs the crypto key for cipher.<br />
        byte[] key = new byte[16];<br />
        //Generates random bytes and places them into the byte array.<br />
        secureRandom.nextBytes(key);<br />
        // IV length is always 16 bytes<br />
        //Constructs the crypto iv for cipher.<br />
        byte[] iv = new byte[16];<br />
        //Generates random bytes and places them into the byte array.<br />
        secureRandom.nextBytes(iv);<br />
        //Closes the SecureRandom.<br />
        secureRandom.close();<br />
        properties = new Properties();<br />
        // Default value is com.intel.chimera.crypto.JceCipher.<br />
        properties.setProperty(&quot;chimera.crypto.cipher.classes&quot;, &quot;com.intel.chimera.crypto.OpensslCipher,com.intel.chimera.crypto.JceCipher&quot;);<br />
        Cipher cipher = Utils.getCipherInstance(CipherTransformation.AES_CTR_NOPADDING, properties);<br />
        int bufferSize = 4096;<br />
        String input = &quot;hello world!&quot;;<br />
        byte[] decryptedData = new byte[1024];<br />
        //Encryption with CryptoOutputStream.<br />
        //Initializes the cipher with ENCRYPT_MODE,key and iv.<br />
        cipher.init(Cipher.ENCRYPT_MODE, key, iv);<br />
        // Constructs the original OutputStream.<br />
        OutputStream outputStream = new ByteArrayOutputStream();<br />
        //Constructs the instance of CryptoOutputStream.<br />
        CryptoOutputStream cos = new CryptoOutputStream(outputStream, cipher, bufferSize, key, iv);<br />
        cos.write(input.getBytes(&quot;UTF-8&quot;));<br />
        cos.flush();<br />
        cos.close();<br />
        // Decryption with CryptoInputStream.<br />
        //Initializes the cipher with DECRYPT_MODE,key and iv.<br />
        cipher.init(Cipher.DECRYPT_MODE, key, iv);<br />
        //Constructs the original InputStream.<br />
        InputStream inputStream = new ByteArrayInputStream(outputStream.toByteArray());<br />
        //Constructs the instance of CryptoInputStream.<br />
        CryptoInputStream cis = new CryptoInputStream(inputStream, cipher, bufferSize, key, iv);<br />
        int decryptedLen = cis.read(decryptedData, 0, 1024);<br />
        cis.close();<br />
        </td>
        </tr>
        </table>
        </ol>
      </div></div>

    </div>
    <!-- ================================================== -->
  

					</td>
				</tr>
			</table>
		</div>

		<div class="footer">
			<p>Copyright &copy;                    2016
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All Rights Reserved.</p>
                                                          				
<div class="center">Apache Commons, Apache Commons Crypto, Apache, the Apache feather logo, and the Apache Commons project logos are trademarks of The Apache Software Foundation.
      All other marks mentioned may be trademarks or registered trademarks of their respective owners.</div>
                          		</div>
	</body>

</html>
